<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<link rel="icon" href="assets/img/favicon.ico">
<title>My Personal Blog</title>
<!-- Bootstrap core CSS -->
<link href="assets/css/bootstrap.min.css" rel="stylesheet">
<!-- Fonts -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
<!-- Custom styles for this template -->
<link href="assets/css/mediumish.css" rel="stylesheet">
</head>
<body>

<!-- Begin Nav
================================================== -->
<nav class="navbar navbar-toggleable-md navbar-light bg-white fixed-top mediumnavigation">
<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="container">
	<!-- Begin Logo -->
	<a class="navbar-brand" href="index.html">
	<img src="assets/img/logo.png" alt="logo">
	</a>
	<!-- End Logo -->
	<div class="collapse navbar-collapse" id="navbarsExampleDefault">
		<!-- Begin Menu -->
		<ul class="navbar-nav ml-auto">
			<li class="nav-item active">
			<a class="nav-link" href="index.html">Stories <span class="sr-only">(current)</span></a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="index.html">Post</a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="author.html">Author</a>
			</li>
		</ul>
		<!-- End Menu -->
		<!-- Begin Search -->
		<form class="form-inline my-2 my-lg-0">
			<input class="form-control mr-sm-2" type="text" placeholder="Search">
			<span class="search-icon"><svg class="svgIcon-use" width="25" height="25" viewbox="0 0 25 25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span>
		</form>
		<!-- End Search -->
	</div>
</div>
</nav>
<!-- End Nav
================================================== -->

<!-- Begin Article
================================================== -->
<div class="container">
	<div class="row">

		<!-- Begin Post -->
		<div class="col-md-8 col-md-offset-2 col-xs-12">
			<div class="mainheading">

				<!-- Begin Top Meta -->
				<div class="row post-top-meta">
					<div class="col-md-2">
						<a href="author.html"><img class="author-thumb" src="assets/img/logo/pen-writing.jpg" alt="Aditi Bhonsle"></a>
					</div>
					<div class="col-md-10">
						<a class="link-dark" href="author.html">Aditi Bhonsle</a>
						<span class="author-description">Author</span><br/>
						<span class="post-date">29 July 2022</span><span class="dot"></span><span class="post-read">6 min read</span>
					</div>
				</div>
				<!-- End Top Menta -->

				<h1 class="posttitle"> Modifying event field configuration value in event-driven microservices architecture</h1>

			</div>

			<!-- Begin Featured Image -->
			<img class="featured-image img-fluid" src="assets/img/demopic/annie-spratt-QckxruozjRg-unsplash.jpg" alt="">
			<!-- End Featured Image -->

			<!-- Begin Post Content -->
			<div class="article-post">
				<body>
					<p>
						In this blog post, I'll be sharing my experience of trying to modify event field config value being passed through events in event-driven microservices architecture.
					</p>
					<h5>
						Background Scenario
					</h5>
					<p>
						To understand our use case, let's assume we have many microservices (ui-service, payment-service, db-service ...) which consumes events generated by our microservice (cart-service).
						<blockquote>
						Every event has a defined structure / schema with pre-defined values associated with it's fields. 
						</blockquote>
						Now, let's assume we have one such event NotifyEvent having a field <i>notified_by</i> which can have any one of configured values: <b>Email</b>, <b>Fax</b>, <b>Courier</b>...
						<br/>
						We discovered that the dev team woking on microservice (delivery-service) has added a new the configuration value for <i>notified_by</i> : <b>POST</b>.
						<br/>
						According to naming conventions of clean code practises, the value for <i>notified_by</i> should be <b>Post</b>.
						For maintaining better consistency, clarity and convenience while writing code, we now have to refactor <b>POST</b> to <b>Post</b>.
						</p>
						<p>
						<blockquote>
							An event structure / schema is considered as a contract between one microservice producing the event and other microservices consuming that event.
							<br/>
							Hence, changing field values configuration can give rise to undesirable consequences in microservices consuming that event.
						</blockquote>
						After a rigorous technical analysis of the microservices communicating using NotifyEvent,
						<ul>
							<li>We identified</li>
							<ul>
								<li>Three microservices, ui-service, user-service, payment-service directly consumed NotifyEvent produced by our microservice, cart-service.</li>
								<li>One microservice, ui-service directly consuming <i>notified_by</i> value of NotifyEvent.</li>
							</ul>
							<li>We did not find any logic in user-service and payment-service that used value of field <i>notified_by</i> of NotifyEvent.</li>
						</ul>
						</p>
						<h5>
							Modifications in codebase
						</h5>
						<p>
							<ul>
								<li>We modified configuration value of <i>notified_by</i> to <b>Post</b>.</li>
								<li>We made changes in ui-service to consume <i>notified_by</i> value as <b>Post</b> in NotifyEvent</li>
							</ul>
						</p>
						<h5>
							Consequences of making above code changes
						</h5>
						<p>
						After pushing the code changes, we got many discrepancies arising due to change the configuration value to <b>Post</b>.
						<br/>
						On analysing the discrepancies we found:
						<ul>
							<li>
								Other teams working on user-service and payment-service had merged their feature changes in respective repos.
								The newly added changes had logic which triggered different events based on the value received in <i>notified_by</i> of NotifyEvent.
							</li>
							These set of events triggered using values of <i>notified_by</i> in user-service and payment-service were then consumed by another set of microservices (gateway-service, invoice-service).
							<li>
								Another microservice, observer-service that was created to record and trace events which are consumed across various microservices (ui-service, db-service, payment-service ...) had now started consuming <i>notified_by</i> field values to analyse for occurance of different configuration values.
							</li>
						</ul>
						</p>
						<h5>
							Resolving the discrepencies
						</h5>
						<p>
						We have to now consider one of the following approaches to resolve the discrepancy:
						<ul>
							<li>
								Revert the code changes related to configuration values of key_alpha.
							</li>
							<li>
								Propagate the correction code related to configuration changes of key_alpha across all directly and indirectly dependent microservices.
							</li>
							This approach is extremely difficult, time-consuming and cause blockage for dev teams working on respective microservices.
						</ul>
						Hence, we chose first approach and reverted our code changes for <i>notified_by</i> value.
					</p>
					<h5>
						Key Takeaways
					</h5>
					<p>
					<ul>
						<li>
							Ensure proper code conventions are followed which introducing new configuration values for every event field.
						</li>
						<li>
							When we need to modify an event field value, we need to throughly analyse all the microservices consuming that event field (directly/indirectly).
						</li>
						<li>
							Also communicate with respective teams working on the dependent microservices to understand if any ongoing development uses that event field value.
						</li>
					</ul>
					</p>
				</body>
			</div>
			<!-- End Post Content -->

			<!-- Begin Tags -->
			<div class="after-post-tags">
				<ul class="tags">
					<li><a href="#">Design</a></li>
					<li><a href="#">Growth Mindset</a></li>
					<li><a href="#">Productivity</a></li>
					<li><a href="#">Personal Growth</a></li>
				</ul>
			</div>
			<!-- End Tags -->

		</div>
		<!-- End Post -->

	</div>
</div>
<!-- End Article
================================================== -->

<div class="hideshare"></div>


<!-- Begin Footer
================================================== -->
<div class="container">
	<div class="footer">
		<p class="pull-left">
			 Copyright &copy; 2022 My Personal Blog
		</p>
		<p class="pull-right">
			Mediumish Theme taken from <a target="_blank" href="https://www.wowthemes.net">WowThemes.net</a>
		</p>
		<div class="clearfix">
		</div>
	</div>
</div>
<!-- End Footer
================================================== -->

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="assets/js/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/ie10-viewport-bug-workaround.js"></script>
<script src="assets/js/mediumish.js"></script>
</body>
</html>
